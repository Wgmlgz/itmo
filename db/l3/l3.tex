\documentclass{article}
\usepackage{import}
\input{../../lib/latex/wgmlgz.tex}


\begin{document}

\itmo[
  variant=371364,
  labn=3,
  discipline=Информационные системы и базы данных,
  group=P3115,
  student=Владимир Мацюк,
  teacher=Горбунов Михаил Витальевич,
  year=2023,
  logo=../../lib/img/itmo.png
]
\lstset{language=SQL}

\section{Текст задания}
Для отношений, полученных при построении предметной области из лабораторной работы №1, выполните следующие действия:
\begin{enumerate}
  \item Опишите функциональные зависимости для отношений полученной схемы (минимальное множество);
  \item Приведите отношения в 3NF (как минимум). Постройте схему на основеNF (как минимум).
  \item Опишите изменения в функциональных зависимостях, произошедшие после преобразования в 3NF (как минимум). Постройте схему на основеNF;
  \item Преобразуйте отношения в BCNF. Докажите, что полученные отношения представлены в BCNF. Если ваша схема находится уже в BCNF, докажите это;
  \item Какие денормализации будут полезны для вашей схемы? Приведите подробное описание.
  \item Придумайте триггер и связанную с ним функцию, относящиеся к вашей предметной области, согласуйте их с преподавателем и реализуйте на языке PL/pgSQL.
\end{enumerate}

\includegraphics[width=\textwidth]{dbdiagram.png}

\section{Функциональные зависимости}
\begin{itemize} 
  \item area:    id -> (position, info);
  \item endpoint id -> (info, area\_id);
  \item entity: id -> (entity\_type, area\_id, full\_name, info);
  \item incedent: id -> (incedent\_type, incedent\_time, area\_id, info);
  \item report: id-> (from\_id, to\_id, incedent\_id, entity\_id, arrive\_date, content );
  \item indications: id -> (incedent\_id, entity\_id, info);
  \item victim:  (entity\_id, incedent\_id) -> (victim\_type)
\end{itemize}

\section{Нормальные формы}

\begin{itemize}
  \item 1NF: Моя модель удовлетворяет 1NF, так как все атрибуты атомарны, и нет повторяющихся групп.
        
  \item 2NF: Моя модель удовлетворяет 2NF, так как все неключевые атрибуты полностью функционально зависят от первичных ключей.
        
  \item 3NF: Моя модель удовлетворяет 3NF, так как все неключевые атрибуты зависят только от первичных ключей, и не содержат транзитивных зависимостей.
        
\end{itemize}
\section{BCNF}
Моя модель удовлетворяет BCNF, так как для все части составного первичного ключа не зависят от неключевого столбца.

\section{Денормализация}

\begin{itemize}
  \item Добавление избыточных атрибутов: В некоторых случаях добавление избыточных атрибутов может улучшить производительность запросов. Например, если часто запрашивается отправная и точка назначения в репорте, можно добавить атрибут from\_postition и to\_postition в таблицу report. Это позволит избежать дополнительных запросов или операци JOIN при каждом запросе, однако необходимо будет обновлять этот атрибут при добавлении или изменении таблиц area и endpoint.
        
  \item Объединение связанных таблиц: В некоторых случаях, объединение таблиц может уменьшить количество операций JOIN и ускорить обработку запросов. Например, можно рассмотреть объединение таблиц area и endpoint, если часто запрашиваются данные о местности и конечной точки одновременно.
\end{itemize}


\section{Функция на языке PL/pgSQL}

Функция всавляет текущую дату в таблицу report, усли она не была указана.
\code{trigger.psql}

\section{Вывод}
При выполнении лабораторной работы я познакомился с понятием нормализации и денормализации. Научился определять функциональные зависимости модели, а также анализировать последнюю на соответствие различным нормальным формам. Познакомился с процедурным языком PL/pgSQL. Изучил эффективные способы денормализации схемы базы данных и ситуации, в которых возможно их применение.

\end{document}
